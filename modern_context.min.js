"use strict";class Context{constructor(target_selector,contents=[]){const style=document.createElement("style");style.textContent='\n:root {\n    --text_color: #333333;\n    --background_color: rgba(255, 255, 255, 0.7);\n    --corner_radius: 0.25em;\n    --font-family: sans-serif;\n}\n\n@media (prefers-color-scheme: dark) {\n    :root {\n        --text_color: white;\n        --background_color: rgba(51, 51, 51, 0.7);\n    }\n}\n\n.modern_context_js_outer {\n    background: var(--background_color);\n    position: absolute;\n    border-radius: var(--corner_radius);\n    box-shadow: 0.1em 0.1em 0.75em rgba(0, 0, 0, 0.3);\n    padding: 0.5em 0;\n    display: none;\n    overflow: hidden;\n    transition: 0.3s cubic-bezier(0.5, 0, 0, 1);\n    cursor: default;\n    user-select: none;\n    backdrop-filter: blur(0.25em);\n    font-family: var(--font-family);\n}\n\n.modern_context_js_outer hr {\n    width: calc(100% - 2em);\n    height: 0.1em;\n    background: var(--text_color);\n    border: none;\n    margin: 0.25em 1em;\n    opacity: 0.5;\n}\n\n.modern_context_js_outer .context_item {\n    width: 100%;\n    padding: 0.5em 1em;\n    color: var(--text_color);\n    box-sizing: border-box;\n    position: relative;\n}\n\n.modern_context_js_outer .context_item::before {\n    content: "";\n    display: block;\n    width: 100%;\n    height: 100%;\n    transition: 0.1s;\n    position: absolute;\n    top: 0;\n    left: 0;\n    background: var(--text_color);\n    opacity: 0;\n}\n\n.modern_context_js_outer .context_item.hover::before {\n    opacity: 0.15;\n}\n\n.modern_context_js_outer .context_item .context_item_inner {\n    transition: 0.1s;\n}\n\n.modern_context_js_outer .context_item:active .context_item_inner {\n    transform: scale(0.9);\n}\n        ',document.body.appendChild(style),this.context=document.createElement("div"),this.context.className="modern_context_js_outer",document.body.appendChild(this.context),this.add_contents(contents),document.querySelectorAll(target_selector).forEach(target=>{target.addEventListener("contextmenu",event=>{this.open(event),event.preventDefault()})}),document.addEventListener("click",event=>{event.target!==this.context&&this.close()},!1),document.addEventListener("keydown",this._watch_keydown.bind(this),!1),this.is_visible=!1}add_item(label,callback=(()=>{})){const item=document.createElement("div");item.className="context_item",item.addEventListener("click",()=>{callback()}),item.addEventListener("mouseover",()=>{this._hover(item)}),item.addEventListener("mouseleave",()=>{this._reset_all_hover_status()});const inner=document.createElement("div");inner.className="context_item_inner",inner.textContent=label,item.appendChild(inner),this.context.appendChild(item)}add_separator(){this.context.appendChild(document.createElement("hr"))}add_contents(contents){for(let i=0;i<contents.length;i++){const content=contents[i],types=["item","separator"];if(!1!==types.includes(content.type))switch(content.type){case"item":const item={label:"",callback:()=>{},...content};item.callback?this.add_item(item.label,item.callback):this.add_item(item.label);break;case"separator":this.add_separator()}}}open(event){const context_show_transition_ms=300;this.context.style.transition="none",event.screenY<window.innerHeight/2?(this.context.style.bottom="auto",this.context.style.top=`${event.pageY}px`):(this.context.style.top="auto",this.context.style.bottom=`${window.innerHeight-event.pageY}px`),event.screenX<window.innerWidth/2?(this.context.style.right="auto",this.context.style.left=`${event.pageX}px`):(this.context.style.left="auto",this.context.style.right=`${window.innerWidth-event.pageX}px`),this.context.style.display="block";const context_height=window.getComputedStyle(this.context).getPropertyValue("height");this.context.style.height="0",this.context.style.transition="300ms",setTimeout(()=>{this.context.style.height=`${context_height}`,setTimeout(()=>{this.context.style.height="auto"},300)},1),this.is_visible=!0}close(){this.context.style.display="none",this._reset_all_hover_status(),this.is_visible=!1}_watch_keydown(key_event){if(!1===this.is_visible)return;const current_selected_item=this.context.querySelector(".context_item.hover")||this.context.querySelector(".context_item"),number_of_items=this.context.querySelectorAll(".context_item").length,hovered_item_index=this._hovered_item_index();switch(key_event.key){case"Escape":const div=document.createElement("div");div.style.display="none",document.body.appendChild(div),div.click(),div.remove();break;case"ArrowDown":null===hovered_item_index?this._hover(0):this._hover(hovered_item_index+1<number_of_items?hovered_item_index+1:0);break;case"ArrowUp":null===hovered_item_index?this._hover(number_of_items-1):this._hover(hovered_item_index-1>=0?hovered_item_index-1:number_of_items-1);break;case"Enter":current_selected_item.click()}key_event.preventDefault()}_reset_all_hover_status(){this.context.querySelectorAll(".context_item.hover").forEach(element=>{element.classList.remove("hover")})}_hover(item){this._reset_all_hover_status(),"number"==typeof item?this.context.querySelectorAll(".context_item").item(item).classList.add("hover"):"object"==typeof item&&item.classList.add("hover")}_hovered_item_index(){const hovered_item=this.context.querySelector(".context_item.hover"),context_items=this.context.querySelectorAll(".context_item");if(!hovered_item)return null;for(let i=0;i<context_items.length;i++)if(hovered_item===context_items[i])return i;return null}}